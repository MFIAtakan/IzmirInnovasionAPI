@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<div class="container">
    <div class="text-center mt-5">
        <h1 class="display-4">Welcome</h1>
        <p>Learn about <a href="https://learn.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>

        <form id="registerForm">
            <div class="form-group">
                <label for="userName">User Name:</label>
                <input type="text" class="form-control" id="userName" name="userName" required />
            </div>

            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" class="form-control" id="email" name="email" required />
            </div>

            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" class="form-control" id="password" name="password" required />
            </div>

            <div class="form-group">
                <label for="role">Role:</label>
                <input type="text" class="form-control" id="role" name="role" required />
            </div>

            <button type="button" class="btn btn-primary" onclick="submitForm()">Register</button>
        </form>

        <script>
            async function submitForm() {
                const form = document.getElementById('registerForm');
                if (form.checkValidity()) {
                    const formData = {
                        userName: document.getElementById('userName').value,
                        email: document.getElementById('email').value,
                        password: document.getElementById('password').value,
                        role: document.getElementById('role').value
                    };

                    const response = await fetch('https://localhost:5043/api/user/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log(result);
                        // Handle successful response
                    } else {
                        console.error('Failed to register:', response.statusText);
                        // Handle error response
                    }
                } else {
                    console.error('Form is not valid');
                    // Handle form validation error
                }
            }
        </script>
    </div>
</div>
